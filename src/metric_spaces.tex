\section{Metric spaces}\label{sec:metric_spaces}
\subsection{Metric spaces}\label{subsec:metric_spaces}

\begin{definition}\label{def:metric_space}\cite[248]{Engelking1989}
  A \Def{metric space} is a set \( X \) along with a function \( \rho: X \times X \to \BR_{\geq 0} \), called a \Def{metric} or \Def{distance function}, such that
  \begin{description}
    \DItem{def:metric_space/identity}[identity] \( \rho(x, y) = 0 \iff x = y \)
    \DItem{def:metric_space/symmetry}[symmetry] \( \rho(x, y) = \rho(y, x) \)
    \DItem{def:metric_space/triangle_inequality}[triangle inequality] \( \rho(x, y) \leq \rho(x, z) + \rho(z, y) \)
  \end{description}

  If instead of \ref{def:metric_space/identity} we have the weaker condition
  \begin{description}
    \DItem{def:metric_space/pseudometric_identity}[pseudometric identity] \( \forall x \in X, \rho(x, x) = 0 \),
  \end{description}
  we call \( \rho \) a \Def{pseudometric} and \( (X, \rho) \) a \Def{pseudometric space}.

  \begin{defenum}
    \DItem{def:metric_space/subspace} If \( A \subseteq X \) is a set, then \( (A, \rho{\restriction_A}) \) is a metric space and it is called a \Def{subspace} of $X$.

    \DItem{def:metric_space/ball} Define the function
    \begin{align*}
      &B: X \times \BR_{>0} \to \Power(X), \\
      &B(x, r) \coloneqq \{ y \in X \colon \rho(x, y) = r \}.
    \end{align*}

    The set \( B(x, r) \) is called a \Def{ball} with \Def{center} \( x \) and \Def{radius} \( r \).

    The ball \( B = B(0, 1) \) is called the \Def{unit ball}.

    \DItem{def:metric_space/closed_ball} The set
    \begin{equation*}
      \Ol{B(x, r)} \coloneqq \Cl(B(x, r))
    \end{equation*}
    is called the \Def{closed ball} with center \( x \) and radius \( r \).

    \DItem{def:metric_space/sphere} The set
    \begin{equation*}
      S(x, r) \coloneqq \partial{B(x, r)}
    \end{equation*}
    is called the \Def{sphere} with center \( x \) and radius \( r \).

    \DItem{def:metric_space/bounded_set} A set \( A \subseteq X \) is called \Def{bounded} if it is contained in some ball \( B(x, r) \).

    \DItem{def:metric_space/bounded_sequence} A sequence\Tinyref{def:sequence} \( \{ x_i \}_{i=1}^\infty \subseteq X \) is called \Def{bounded} if the corresponding set \( \{ x_i \colon i = 1, 2, \ldots \} \) is bounded\Tinyref{def:metric_space/bounded_set}.

    \DItem{def:metric_space/bounded_metric} If every set is bounded, we say that the metric itself is bounded.

    \DItem{def:metric_space/bounded_function} We say that a function \( f: S \to X \) from a set \( S \) to a metric space \( (X, \rho) \) is \Def{bounded} if its image \( f(S) \) is a bounded set in \( (X, \rho) \).

    \DItem{def:metric_space/diameter} Define the partial\Tinyref{def:function/partial} function
    \begin{align*}
      &\Diam: \Power(X) \to \BR_{\geq 0}, \\
      &\Diam(A) \coloneqq \sup \{ \rho(x, y) \colon x, y \in A \}.
    \end{align*}

    If it exists, we call the number \( \Diam(A) \) the \Def{diameter of \( A \)}.

    \DItem{def:metric_space/distance} Define the function
    \begin{align*}
      &\Dist: X \times \Power(X) \to \BR_{\geq 0}, \\
      &\Dist(x, A) \coloneqq \inf \{ \rho(x, a) \colon a \in A \}.
    \end{align*}

    We call the number \( \Dist(x, A) \) the \Def{distance from the point \( x \) to the set \( A \)}. We use the convention that the infimum of an empty set of real numbers is \( +\infty \), hence \( \Dist(x, \varnothing) = \infty \).
  \end{defenum}
\end{definition}

\begin{proposition}\label{thm:pseudometric_to_metric}
  Let \( (X, \rho) \) be a pseudometric space\Tinyref{def:metric_space}. Define the equivalence relation
  \begin{equation*}
    x \cong y \iff \rho(x, y) = 0.
  \end{equation*}

  Then the quotient set\Tinyref{thm:equivalence_partition} \( M \coloneqq X / \cong \) is a metric space with the metric
  \begin{align*}
    &\rho: M \times M \to \BR_{\geq 0} \\
    &\rho([x], [y]) \coloneqq \rho(x, y).
  \end{align*}
\end{proposition}
\begin{proof}
  The function \( \rho \) is well defined since, if \( x \) and \( y \) both belong to the same equivalence class \( [x] \), then \( \rho(x) = \rho(y) \). Thus \( \rho \) does not depend on the choice of representatives.

  Additionally, \( \rho \) is a metric since \( \rho([x], [y]) = 0 \) implies that \( [x] = [y] \), that is, \( \rho(x, y) = 0 \).
\end{proof}

\begin{proposition}\label{remark:bounded_set_metric_order_equivalence}
  A set \( A \) in a metric space \( (X, \rho) \) is bounded\Tinyref{def:metric_space/bounded_set} if and only if the set \( \{ \rho(a, b) \colon a, b \in A \} \) is bounded as a poset\Tinyref{def:poset/bounded_set}.
\end{proposition}

\begin{definition}\label{def:metric_topology}\cite[249]{Engelking1989}
  Let \( (X, \rho) \) be a metric space. We define the \Def{metric topology} or \Def{induced topology} \( \Cal{T} \) as the topology\Tinyref{def:topological_space} generated by the neighborhood system\Tinyref{def:topological_local_base}
  \begin{equation*}
    \Cal{B}(x) \coloneqq \{ B(x, r) \colon r \in \BR_{>0} \}.
  \end{equation*}

  If for some topological space \( (X, \Cal{T}) \) there exists a metric such that \( \Cal{T} \) is its induced topology, we say that the topology \( \Cal{T} \) is \Def{metrizable}.
\end{definition}
\begin{proof}
  This is indeed a neighborhood system as it satisfies \ref{thm:topological_local_base_axioms/BP1}-\ref{thm:topological_local_base_axioms/BP3}:

  \begin{description}
    \RItem{thm:topological_local_base_axioms/BP1} Every point \( x \) belongs to any ball centered at \( x \).

    \RItem{thm:topological_local_base_axioms/BP2} Fix \( x \in X \) and two balls \( B(x, r) \) and \( B(x, s) \). Then
    \begin{equation*}
      B(x, \min\{ r, s \}) \subseteq B(x, r) \cap B(x, s).
    \end{equation*}

    \RItem{thm:topological_local_base_axioms/BP3} Fix \( x, y \in X \) and let \( x \in B(y, r) \), i.e. \( \rho(x, y) < r \).

    Define
    \begin{equation*}
      s \coloneqq \min\{ \rho(x, y), r - \rho(x, y) \}.
    \end{equation*}

    Let \( z \in B(x, s) \). There are two cases:
    \begin{itemize}
      \item if \( \rho(x, y) \leq \tfrac r 2 \), then
      \begin{align*}
        \rho(z, y)
        \leq
        \rho(z, x) + \rho(x, y)
        <
        s + \rho(x, y)
        \leq
        \rho(x, y) + \rho(x, y)
        \leq
        2 \tfrac r 2
        =
        r.
      \end{align*}

      \item if \( \rho(x, y) > \tfrac r 2 \), then
      \begin{align*}
        \rho(z, y)
        \leq
        \rho(z, x) + \rho(x, y)
        <
        s + \rho(x, y)
        \leq
        (r - \rho(x, y)) + \rho(x, y)
        =
        r.
      \end{align*}
    \end{itemize}

    In both cases, \( B(x, s) \subseteq B(y, r) \).

    \begin{figure}\label{def:metric_topology/nested_balls}
      \centering
      \begin{mplibcode}
        u := 1cm;
        r := sqrt(2) / 2;

        pair v;
        v := (1, 1);

        beginfig(1);
          draw fullcircle scaled 3u;
          dotlabel.bot("$y$", origin);

          draw fullcircle scaled 1u shifted (-r * u * v);
          dotlabel.bot("$x_1$", -r * u * v);

          draw fullcircle scaled 1u shifted (r/2 * u * v);
          dotlabel.bot("$x_2$", r/2 * u * v);
        endfig;
      \end{mplibcode}
      \caption{There is a nested ball around every point in an open ball}
    \end{figure}
  \end{description}
\end{proof}

\begin{proposition}\label{thm:locally_countable_metric_topology}
  The following is an alternative base for the metric topology\Tinyref{def:metric_topology}:

  \begin{equation*}
    \Cal{B}(x) \coloneqq \{ B (x, \tfrac 1 n) \colon n = 1, 2, 3, \ldots \}.
  \end{equation*}
\end{proposition}
\begin{proof}
  The proof is the same as in \cref{def:metric_topology}, except for a slight tweak in \ref{thm:topological_local_base_axioms/BP3}, where we define \( m \) to be the the smallest positive integer such that
  \begin{equation*}
    \tfrac 1 m \leq \min\{ \rho(x, y), r - \rho(x, y) \}.
  \end{equation*}

  Note that \( m \) exists by \cref{thm:ordinals_are_well_ordered}.

  We then obtain \( B(x, \tfrac 1 m) \subseteq B(y, \tfrac 1 n) \).
\end{proof}

\begin{proposition}\label{thm:metric_topology_properties}
  The metric topology \( \Cal{T} \) on \( X \) induced by \( \rho \) has the following properties:
  \begin{defenum}
    \DItem{thm:metric_topology_properties/ball_is_open} For every point \( x \in X \) and any radius \( r > 0 \), the ball \( B(x, r) \) is an open set and, hence, a neighborhood of \( x \).
    \DItem{thm:metric_topology_properties/first_countable} \( \Cal{T} \) is first-countable.
    \DItem{thm:metric_topology_properties/hausdorff} \( \Cal{T} \) is Hausdorff.
  \end{defenum}
\end{proposition}
\begin{proof}
  \begin{description}
    \RItem{thm:metric_topology_properties/ball_is_open} Obvious from \cref{def:metric_topology}.

    \RItem{thm:metric_topology_properties/first_countable} Since \cref{thm:locally_countable_metric_topology} involves generating a topology using a neighborhood system of countable local neighborhoods, \( \Cal{T} \) is first-countable.

    \RItem{thm:metric_topology_properties/hausdorff} Let \( x, y \in X \) be distinct points. Define
    \begin{equation*}
      r \coloneqq \dfrac 1 2 \rho(x, y),
    \end{equation*}
    so that
    \begin{equation*}
      B(x, r) \cap B(y, r) = \varnothing.
    \end{equation*}
  \end{description}
\end{proof}

\begin{proposition}\label{thm:metric_topology_convergence}
  Let \( (X, \rho) \) be a metric space and \( \Cal{T} \) be the induced metric topology\Tinyref{def:metric_topology}. The convergence\Tinyref{subsec:convergence} in \( \Cal{T} \) is the completely described by sequences, that is,

  \begin{defenum}
    \DItem{thm:metric_topology_convergence/single_limit} every converging net\Tinyref{def:topological_net} has a single limit.

    \DItem{thm:metric_topology_convergence/cluster_point} \( x \in X \) is a cluster point\Tinyref{def:net_cluster_point} of the sequence \( \{ x_i \}_{i=1}^\infty \) if and only if for every positive real number \( \varepsilon > 0 \) and every index \( i_0 \) there exists an index \( i_\varepsilon > i_0 \) such that
    \begin{equation*}
      \rho(x, x_{i_\varepsilon}) < \varepsilon.
    \end{equation*}

    \DItem{thm:metric_topology_convergence/limit_point} \( x \in X \) is a limit point\Tinyref{def:net_limit_point} of the sequence \( \{ x_i \}_{i=1}^\infty \) if and only if for every positive real number \( \varepsilon > 0 \) there exists an index \( i_0 \) such that
    \begin{equation*}
      i \geq i_0 \implies \rho(x, x_i) < \varepsilon.
    \end{equation*}

    \DItem{thm:metric_topology_convergence/closure} given any set \( A \subseteq X \), a point \( x \in X \) belongs to \( \Cl{A} \) if and only if there exists a sequence \( \{ x_i \}_{i=1}^\infty \subseteq A \) such that \( x_i \xrightarrow[i \to \infty]{} x \) (compare with \cref{thm:limit_point_iff_in_closure}).
  \end{defenum}
\end{proposition}
\begin{proof}
  \begin{description}
    \RItem{thm:metric_topology_convergence/single_limit} Follows directly from \cref{thm:t2_iff_singleton_limits} and \cref{thm:metric_topology_properties/hausdorff}.

    \RItem{thm:metric_topology_convergence/cluster_point} Fix a sequence \( x_i \to x \).

    \begin{description}
      \Implies Fix a radius \( \varepsilon > 0 \) and an index \( i_0 \). Note that \( B(x, \varepsilon) \) is a neighborhood of \( x \) and hence by \cref{def:net_cluster_point} there exists an index \( i_\varepsilon \geq i_0 \) such that \( x_{i_U} \in B(x, \varepsilon) \), which is the same as
      \begin{equation*}
        \rho(x, x_{i_U}) < \varepsilon.
      \end{equation*}

      \ImpliedBy Fix a neighborhood \( U \) of \( x \). Since the topology is generated by a local base of balls, then \( U \) contains some ball \( B(x, r) \). Thus there exists an index \( i_0 \), such that
      \begin{equation*}
        \rho(x, x_{i_r}) < r,
      \end{equation*}
      hence
      \begin{equation*}
        x_{i_r} \in B(x, r) \subseteq U.
      \end{equation*}
    \end{description}

    \RItem{thm:metric_topology_convergence/limit_point} Similar to \ref{thm:metric_topology_convergence/cluster_point}.

    \RItem{thm:metric_topology_convergence/closure}
    \begin{description}
      \Implies Fix a nonempty set \( A \) and \( x \in \Cl A \). If \( x \in A \), then the constant sequence with all members equal to \( x \) converges to \( A \).

      Assume that \( x \not\in A \) and choose any sequence\AOC
      \begin{equation*}
        x_i \in B(x, \tfrac 1 i) \setminus \{ x \}, i = 1, 2, \ldots.
      \end{equation*}

      Fix \( \varepsilon > 0 \). By \cref{thm:ordinals_are_well_ordered} there exists a least positive integer \( i_0 \) such that \( \tfrac 1 i_0 < \varepsilon \). It follows that \( x_i \to x \) since
      \begin{equation*}
        i \geq i_0 \implies \rho(x, x_i) \leq \rho(x, x_{i_0}) \leq \varepsilon.
      \end{equation*}

      \ImpliedBy Obvious
    \end{description}
  \end{description}
\end{proof}

\begin{definition}\label{def:isometry}\cite[253]{Engelking1989}
  Let \( (X, \rho) \) and \( (Y, \nu) \) be two metric spaces\Tinyref{def:metric_space}. We say that the function \( f: X \to Y \) is a \Def{distance preserving map} or \Def{isometry} or \Def{isometric embedding} if
  \begin{equation*}
    \forall x, y \in X, \rho(x, y) = \nu(f(x), f(y)).
  \end{equation*}

  If \( f \) is bijective, we say that \( X \) and \( Y \) are \Def{isometric}.
\end{definition}

\begin{proposition}\label{def:isometry_is_injective}
  An isometry\Tinyref{def:isometry} \( f: (X, \rho) \to (Y, \nu) \) is always injective.
\end{proposition}
\begin{proof}
  If\LEM \( f(x) = f(x') \), then by \ref{def:metric_space/identity}, \( x = x' \).
\end{proof}

\begin{definition}\label{def:category_of_metric_spaces}
  We denote by \( \Cat{Top} \) the subcategory\Tinyref{def:subcategory} of \( \Bold{Top} \)\Tinyref{def:category_of_topological_spaces} where
  \begin{itemize}
    \item the class\Tinyref{def:set_zfc} of objects is the class of all metric spaces\Tinyref{def:metric_space}.
    \item the morphisms between two topological spaces are the isometries\Tinyref{def:isometry} between them.
  \end{itemize}
\end{definition}

\begin{definition}\label{def:equivalent_metrics}
  Two metrics \( \rho \) and \( \nu \) on the set \( X \) are said to be \Def{equivalent} if \( \rho \) and \( \nu \) have the same metric topology\Tinyref{def:metric_topology}. They are said to be \Def{strongly equivalent} if there exist constants \( \alpha, \beta \in \BR \) such that for every \( x, y \in X \) we have
  \begin{equation*}
    \alpha \nu(x, y) \leq \rho(x, y) \leq \beta \nu(x, y).
  \end{equation*}
\end{definition}

\begin{theorem}\label{thm:real_metric_and_order_topologies_coincide}
  For the real numbers, the metric\Tinyref{def:metric_topology} and order\Tinyref{def:order_topology} topologies coincide.
\end{theorem}
\begin{proof}
  The metric topology \( \Cal{T}_M \) is generated by the base\Tinyref{def:topological_base}
  \begin{equation*}
    \Cal{B} \coloneqq \{ B(x, r) \colon x \in \BR, r \in \BR_{>0} \}
  \end{equation*}
  and the order topology \( \Cal{T}_O \) is generated by the subbase\Tinyref{def:topological_subbase}
  \begin{equation*}
    \Cal{P} \coloneqq \{ (a, \infty) \colon a \in \BR \} \cup \{ (\infty, b) \colon b \in \BR \}.
  \end{equation*}

  The inclusion \( \Cal{B} \subseteq FI(\Cal{P}) \) is obvious since any ball \( B(x, r) \) is the intersection of the two rays
  \begin{equation*}
    B(x, r) = (x - r, \infty) \cap (-\infty, x + r).
  \end{equation*}

  Thus \( \Cal{T}_M \subseteq \Cal{T}_O \). We now only need to show that \( \Cal{B} \) is a base for \( \Cal{T}_O \).

  Let \( U \in \Cal{T}_O \). Since \( FI(\Cal{P}) \) is a base for \( \Cal{T}_O \), there exists\Tinyref{def:topological_base/union} a family \( \{ U_i \}_{i \in I} \subseteq FI(\Cal{P}) \) such that
  \begin{equation*}
    U = \bigcup_{i \in I} U_i.
  \end{equation*}

  We only need to express every \( U_i \) as a union of balls from \( \Cal{B} \). There are several possibilities:
  \begin{itemize}
    \item if \( U_i \) is the open interval \( (a, \infty) \),
    \begin{equation*}
      (a, \infty) = \bigcup_{i=1}^\infty B(a + i, 1).
    \end{equation*}

    \item if \( U_i \) is the open interval \( (-\infty, b) \),
    \begin{equation*}
      (-\infty, b) = \bigcup_{i=1}^\infty B(b - i, 1).
    \end{equation*}

    \item if \( U_i \) is the intersection \( (a, \infty) \cap (-\infty, b), a < b \),
    \begin{equation*}
      (a, \infty) \cap (-\infty, b) = B(\tfrac {a + b} 2, \tfrac {b - a} 2)
    \end{equation*}

    \item if \( U_i \) is the empty set,
    \begin{equation*}
      \varnothing = \bigcup \varnothing \text{ (see \cref{def:set_union})}.
    \end{equation*}
  \end{itemize}

  Thus \( U_i \) is the union of an at most countable amount of balls. The countable union of countable sets is again countable, hence by \cref{def:topological_base/union}, \( \Cal{B} \) is a base for \( \Cal{T}_O \).
\end{proof}

\begin{definition}\label{def:fundamental_sequence}
  Let \( (X, \rho) \) be a metric space. We say that the sequence \( \{ x_i \}_{i=1}^n \subseteq X \) is a \Def{fundamental sequence} or \Def{Cauchy sequence} if, for any \( \varepsilon > 0 \), there exists an index \( i_0 \) such that
  \begin{equation*}
    i, j \geq i_0 \implies \rho(x_i, x_j) < \varepsilon.
  \end{equation*}
\end{definition}

\begin{proposition}\label{thm:fundamental_sequence_is_bounded}
  Any fundamental sequence \( \{ x_i \}_{i=1}^n \) is bounded\Tinyref{def:metric_space/bounded_sequence}.
\end{proposition}
\begin{proof}
  Fix \( \varepsilon > 0 \). There exists an index \( i_0 \) such that
  \begin{equation*}
    i, j \geq i_0 \implies \rho(x_i, x_j) < \varepsilon.
  \end{equation*}

  Since the set
  \begin{equation*}
    I \coloneqq \{ x_i \colon i \leq i_0 \}
  \end{equation*}
  is finite, it has a finite diameter\Tinyref{def:metric_space/diameter}.

  Let \( i < i_0 \) and \( j \geq i_0 \). Then
  \begin{equation*}
    \rho(x_i, x_j) \leq \rho(x_i, x_{i_0}) + \rho(x_{i_0}, x_j) < \Diam(I) + \varepsilon,
  \end{equation*}
  which is a finite number.

  Thus the distance between any two elements of the sequence is finite and the sequence is bounded.
\end{proof}

\begin{proposition}\label{thm:fundamental_subsequence_convergence}
  In any metric space\Tinyref{def:complete_metric_space}, a fundamental sequence\Tinyref{def:fundamental_sequence} converges to a value if and only if it has a subsequence that converges to the same value.
\end{proposition}
\begin{proof}
  Let \( (X, \rho) \) be a metric space and let \( \{ x_i \}_{i=1}^\infty \) be a fundamental sequence.

  \begin{description}
    \Implies Obvious
    \ImpliedBy Assume that the subsequence \( \{ x_{i_k} \}_{k=1}^\infty \) converges to \( x \). Fix \( \varepsilon > 0 \). There exist \( i_0 \) and \( k_0 \) such that
    \begin{align*}
      &i, j \geq i_0 \implies \rho(x_i, x_j) < \tfrac \varepsilon 2 \\
      &k \geq k_0 \implies \rho(x, x_{i_k}) < \tfrac \varepsilon 2
    \end{align*}

    Fix \( i \geq i_0 \) and let \( k \geq k_0 \) be such that \( i_k \geq i_0 \). Then
    \begin{equation*}
      \rho(x, x_i) \leq \rho(x, x_{i_k}) + \rho(x_{i_k}, x_i) < \varepsilon.
    \end{equation*}

    Since \( \varepsilon \) was arbitrary, we conclude that \( \lim_{i \to \infty} x_i = \lim_{k \to \infty} x_{i_k} = x \).
  \end{description}
\end{proof}

\begin{definition}\label{def:complete_metric_space}
  We say that a metric space is \Def{complete} if every fundamental sequence\Tinyref{def:fundamental_sequence} has a limit\Tinyref{thm:metric_topology_convergence/limit_point}.

  An isometry \( f: X \to Y \) is called a \Def{completion} of \( X \) if \( Y \) is complete and \( f(X) \) is dense\Tinyref{def:topologically_dense_set/dense} in \( Y \) (see \cref{thm:metric_space_completion_existence}).
\end{definition}

\begin{proposition}\label{thm:convergent_sequence_is_fundamental}
  In a complete metric space\Tinyref{def:complete_metric_space}, every convergent\Tinyref{def:net_limit_point}\Tinyref{thm:metric_topology_convergence/limit_point} sequence is fundamental\Tinyref{def:fundamental_sequence}.
\end{proposition}
\begin{proof}
  Let \( (X, \rho) \) be a complete metric space and \( \{ x_i \}_{i=1}^\infty \) be a sequence that converges to \( x \). Fix \( \varepsilon > 0 \). Then there exists an index \( i_0 \) such that
  \begin{equation*}
    i \geq i_0 \implies \rho(x, x_i) < \tfrac \varepsilon 2.
  \end{equation*}

  Then
  \begin{equation*}
    i, j \geq i_0 \implies \rho(x_i, x_j) \leq \rho(x_i, x) + \rho(x, x_j) < \tfrac \varepsilon 2 + \tfrac \varepsilon 2 = \varepsilon.
  \end{equation*}

  Since \( \varepsilon > 0 \) was arbitrary, we conclude that the sequence is fundamental.
\end{proof}

\begin{corollary}[Cauchy's convergence criterion]\label{thm:cauchys_convergence_criterion}
  A sequence in a complete metric space is convergent\Tinyref{def:net_limit_point}\Tinyref{thm:metric_topology_convergence/limit_point} if and only if it is a fundamental sequence\Tinyref{def:fundamental_sequence}.

  Explicitly, a sequence \( \{ x_k \}_{k=1}^\infty \) in a metric space\Tinyref{def:metric_space} \( (X, \rho) \) is convergent\Tinyref{def:net_limit_point} if and only if for every \( \varepsilon > 0 \) there exists an index \( K \) such that
  \begin{equation*}
    k, m \geq K \implies \rho(x_k, x_m) < \varepsilon.
  \end{equation*}
\end{corollary}
\begin{proof}
  \begin{description}
    \Implies Given by \cref{thm:convergent_sequence_is_fundamental}
    \ImpliedBy Given by \cref{def:complete_metric_space}
  \end{description}
\end{proof}

\begin{proposition}\label{thm:metric_convergence_of_function_at_point}
  Fix two metric spaces \( X \) and \( Y \), let \( D \subseteq X \) be a nonempty open set and let \( f: D \to Y \) be any function. Then \( f \) \Def{converges} to \( \Ol y \in Y \) at \( \Ol x \in \Cl(D) \) if any of the following conditions hold
  \begin{thmenum}
    \DItem{def:convergence_of_function_at_point/balls} For every \( \varepsilon > 0 \) there exists \( \delta > 0 \) such that for \( x \in D \) we have
    \begin{equation*}
      \rho_X(\Ol x, x) < \delta \implies \rho_Y(\Ol y, f(x)) < \varepsilon
    \end{equation*}
    or, equivalently,
    \begin{equation}\label{def:convergence_of_function_at_point/balls/inclusion}
      f(B(\Ol x, \delta) \cap D) \subseteq B(\Ol y, \varepsilon)
    \end{equation}

    \DItem{def:convergence_of_function_at_point/sequences} For every sequence \( \{ x_i \}_{i=1}^\infty \subseteq D \) that converges to \( \Ol x \), the corresponding sequence \( \{ f(x_i) \}_{i=1}^\infty \) converges to \( \Ol y \).
  \end{thmenum}
\end{proposition}
\begin{proof}
  It is obvious that \cref{def:convergence_of_function_at_point/balls} is a special case of \cref{def:convergence_of_function_at_point} and by \cref{def:metric_topology}, they are equivalent.

  \Implies[def:convergence_of_function_at_point/balls][def:convergence_of_function_at_point/sequences] Fix \( \varepsilon > 0 \) and suppose that for some \( \delta > 0 \) \cref{def:convergence_of_function_at_point/balls/inclusion} holds. Let \( \{ x_i \}_{i=1}^\infty \subseteq D \) be a sequence that converges to \( \Ol x \). Thus, for some index \( i_0 \), we have
  \begin{equation*}
    i \geq i_0 \implies f(x_i) \subseteq B(\Ol y, \varepsilon).
  \end{equation*}

   Since \( \varepsilon \) was arbitrary, \cref{thm:metric_topology_convergence/limit_point} allows us to conclude that \( \{ f(x_i) \}_{i=1}^\infty \) converges to \( \Ol y \).

   \Implies[def:convergence_of_function_at_point/sequences][def:convergence_of_function_at_point/balls] Suppose that for every sequence \( \{ x_i \}_{i=1}^\infty \subseteq D \) that converges to \( \Ol x \), the corresponding sequence \( \{ f(x_i) \}_{i=1}^\infty \) converges to \( \Ol y \).

   Fix \( \varepsilon > 0 \) and suppose that \cref{def:convergence_of_function_at_point/balls/inclusion} does not hold for any \( \delta > 0 \).

   Choose\AOC for every \( i = 1, 2, \ldots \) an element \( x_i \in B(\Ol x, \tfrac 1 i) \cap D \) such that
   \begin{equation*}
     \rho_Y(f(x_i), \Ol y) \geq \varepsilon.
   \end{equation*}

   Then the sequence \( \{ x_i \}_{i=1}^\infty \) converges to \( \Ol x \) by \cref{thm:metric_topology_convergence/limit_point}, but \(\{ f(x_i) \}_{i=1}^\infty \) does not converge to \( \Ol y \). This contradicts our assumption~\ref{def:convergence_of_function_at_point/sequences}.

   The obtained contradiction proves the theorem.
\end{proof}

\begin{theorem}\label{thm:metric_space_continuity}
  A function \( f: X \to Y \) between metric spaces is continuous\Tinyref{def:continuous_function} at \( \Ol x \in X \) if and only if any of the following conditions hold
  \begin{thmenum}
    \DItem{thm:metric_space_continuity/balls} Cauchy's continuity criterion is satisfied: for every \( \varepsilon > 0 \) there exists \( \delta > 0 \) such that for every \( x \in X \) we have
    \begin{equation}\label{thm:metric_space_continuity/inequality}
      \rho_X(\Ol x, x) < \delta \implies \rho_Y(f(\Ol x), f(y)) < \varepsilon
    \end{equation}
    or, equivalently,
    \begin{equation}\label{thm:metric_space_continuity/inclusion}
      f(B(\Ol x, \delta)) \subseteq B(f(\Ol x), \varepsilon)
    \end{equation}

    \DItem{thm:metric_space_continuity/sequences} Heine's continuity criterion is satisfied: for every sequence \( \{ x_i \}_{i=1}^\infty \) that converges to \( \Ol x \), the image\Tinyref{def:function} \( \{ f(x_i) \}_{i=1}^\infty \) converges to \( f(\Ol x) \). Symbolically,
    \begin{equation}\label{thm:metric_space_continuity/sequences/limit}
      \lim_{i \to \infty} f(x_i) = f\left(\lim_{i \to \infty} x_i \right) \ f(\Ol x).
    \end{equation}
  \end{thmenum}
\end{theorem}
\begin{proof}
  \begin{description}
    \RItem{thm:metric_space_continuity/balls} By \cref{def:metric_topology}, the balls in \( X \) and \( Y \) form a neighborhood \Tinyref{def:topological_local_base} for the metric topology. Then by \cref{def:continuous_function/local_base}, the continuity of \( f \) is equivalent to \cref{thm:metric_space_continuity/balls}.

    \RItem{thm:metric_space_continuity/sequences} By \cref{thm:metric_topology_convergence/closure}, this condition is equivalent to \cref{def:continuous_function/closure}.
  \end{description}
\end{proof}

\begin{theorem}[Cantor's nested compact theorem]\label{thm:cantors_nested_compact_theorem}
  A descending sequence of nonempty compact sets \( F_1 \supseteq F_2 \supseteq \ldots \) in a complete metric space such that \( \Diam(F_i) \to 0 \) intersects at exactly one point (compare with \cref{thm:noncompact_kuratowski_lemma}).
\end{theorem}
\begin{proof}
  Choose\AOC an element \( x_i \in F_i \) for any \( i = 1, 2, \ldots \). Then the sequence \( \{ x_i \}_{i=1}^\infty \) is fundamental. To see this, let \( \varepsilon > 0 \) and let \( i_0 \) be an index such that \( \Diam(F_{i_0}) < \varepsilon \). Then if \( j \geq i \geq i_0 \), \( x_j \) is contained in \( F_i \) and \( \rho(x_i, x_j) < \varepsilon \). Thus the sequence is indeed fundamental and, since the space is complete, it has a limit point \( x \).

  The point \( x \) is contained in every set \( F_i, i = 1, 2, \ldots \) since all of the sets \( F_i \) are closed (by \cref{thm:complete_metric_space_compact_conditions}) and contain their limit points\Tinyref{thm:limit_point_iff_in_closure}. Thus
  \begin{equation*}
    x \in \bigcap_{i=1}^\infty F_i.
  \end{equation*}

  Furthermore,
  \begin{equation*}
    \Diam\left( \bigcap_{i=1}^\infty F_i \right) = 0,
  \end{equation*}
  hence \( x \) is the only point in the intersection.
\end{proof}

\begin{theorem}[Metric space completion]\label{thm:metric_space_completion_existence}
  Every metric space has a completion\Tinyref{def:complete_metric_space}.
\end{theorem}
\begin{proof}
  Let \( (X, \rho) \) be a metric space.

  \begin{defenum}
    \DItem{thm:metric_space_completion_existence/part_a} First, we build the pseudometric space \( (F, \rho) \). We deal with fundamental sequences and isometries in pseudometric spaces, where the definitions, however, does not change.

     Define \( F \) to be the set of all fundamental sequences\Tinyref{def:fundamental_sequence} in X. Define the pseudometric
    \begin{align*}
      &\rho: F \times F \to \BR_{\geq 0} \\
      &\rho\left( \{ x_i \}_{i=1}^\infty, \{ y_i \}_{i=1}^\infty \right) \coloneqq \lim_{i \to \infty} \rho(x_i, y_i).
    \end{align*}

    We first show that is well defined as a function\Tinyref{def:function}. Let \( \{ x_i \}_{i=1}^\infty \) and \( \{ y_i \}_{i=1}^\infty \) be two sequences. Fix \( \varepsilon > 0 \). Then there exists an \( i_0 \) such that
    \begin{equation*}
      i, j \geq i_0 \implies \rho(x_i, x_i) < \tfrac \varepsilon 2 \text{ and } \rho(y_i, y_j) < \tfrac \varepsilon 2.
    \end{equation*}

    Fix \( i, j \geq i_0 \). Then
    \begin{equation*}
      \rho(x_i, y_i) \leq \rho(x_i, x_j) + \rho(x_j, y_j) + \rho(y_j, y_i) < \rho(x_j, y_j) + \varepsilon,
    \end{equation*}
    hence
    \begin{equation*}
      \Abs{\rho(x_i, y_i) - \rho(x_j, y_j)} < \varepsilon.
    \end{equation*}

    Thus the sequence \( \{ \rho(x_i, y_i) \}_{i=1}^\infty \) is fundamental and, by \cref{def:real_numbers_complete_metric_space}, it is convergent.

    Now we check that \( \rho \) is indeed a pseudometric:
    \begin{description}
      \RItem{def:metric_space/pseudometric_identity} For every sequence \( x \in F \),
      \begin{equation*}
        \rho(x, x) = \lim_{i \to \infty} \rho(x_i, x_i) = 0.
      \end{equation*}
      \RItem{def:metric_space/symmetry} For all sequences \( x, y \in F \),
      \begin{equation*}
        \rho(x, y) = \lim_{i \to \infty} \rho(x_i, y_i) = \lim_{i \to \infty} \rho(y_i, x_i) = \rho(y, x).
      \end{equation*}

      \RItem{def:metric_space/triangle_inequality} For all sequences \( x, y, z \in F \),
      \begin{equation*}
        \rho(x, z) = \lim_{i \to \infty} \rho(x_i, z_i) \leq \lim_{i \to \infty} \rho(x_i, y_i) + \lim_{i \to \infty} \rho(y_i, z_i) = \rho(x, y) + \rho(y, z).
      \end{equation*}
    \end{description}

    \DItem{thm:metric_space_completion_existence/part_b} We prove that every fundamental sequence in \( (F, \rho) \) is convergent.

    Let \( \{ c^{(i)} \}_{i=1}^\infty \) be a fundamental sequence (of sequences) in \( (F, \rho) \). Thus, for every \( i = 1, 2, \ldots \), there exists an index \( n_i \) such that
    \begin{equation*}
      j \geq n_i \implies \rho(c_j^{(i)}, c_{n_i}^{(i)}) < \tfrac 1 i.
    \end{equation*}

    Define the sequence
    \begin{equation*}
      d_i \coloneqq c_{n_i}^{(i)}, i = 1, 2, \ldots.
    \end{equation*}

    To see that it is fundamental, fix \( \varepsilon > 0 \). Now since the sequence \( \{ c^{(i)} \} \) in \( F \) is fundamental, there exists \( i_0 \) such that
    \begin{equation*}
      i, j \geq i_0 \implies \rho(c^{(i)}, c^{(j)}) = \lim_{k \to \infty} \rho(c_k^{(i)}, c_k^{(j)}) < \frac \varepsilon 2.
    \end{equation*}

    Let \( j_0 \geq i_0 \) be an index such that
    \begin{equation*}
      \frac 2 {j_0} < \frac \varepsilon 2.
    \end{equation*}

    Fix \( i \geq j \geq j_0 \). Let \( l \geq \max \{ n_i, n_j \} \) be such that
    \begin{equation*}
      \rho(c_l^{(i)}, c_l^{(j)}) < \frac \varepsilon 2.
    \end{equation*}

    Then
    \begin{align*}
      \rho(d_i, d_j)
      &=
      \rho(c_{n_i}^{(i)}, c_{n_j}^{(j)})
      \leq \\ &\leq
      \rho(c_{n_i}^{(i)}, c_l^{(i)}) + \rho(c_l^{(i)}, c_l^{(j)}) + \rho(c_l^{(j)}, c_{n_j}^{(j)})
      \leq \\ &\leq
      \frac 1 i + \frac \varepsilon 2 + \frac 1 j
      \leq
      \frac 2 j + \frac \varepsilon 2
      <
      \varepsilon.
    \end{align*}

    Thus we have
    \begin{equation*}
      i \geq j \geq j_0 \implies \rho(d_i, d_j) < \varepsilon,
    \end{equation*}
    which proves that the sequence \( \{ d_i \}_{i=1}^\infty \) is fundamental in \( (X, \rho) \).

    Now it remains to show that \( c^{(i)} \xrightarrow[i \to \infty]{} d \) in \( (F, \rho) \).

    Fix \( \varepsilon > 0 \) and let \( i_0 \) be such that
    \begin{equation*}
      \frac 1 {i_0} \leq \frac \varepsilon 2.
    \end{equation*}
    and
    \begin{equation*}
      i, j \geq i_0 \implies \rho(d_i, d_j) < \frac \varepsilon 2.
    \end{equation*}

    Now fix \( i \geq i_0 \). We have, for all \( k \geq i \),
    \begin{align*}
      \rho(c_{n_k}^{(i)}, d_k)
      &=
      \rho(c_{n_k}^{(i)}, c_{n_k}^{(k)})
      \leq \\ &\leq
      \rho(c_{n_k}^{(i)}, c_{n_i}^{(i)}) + \rho(c_{n_i}^{(i)}, c_{n_k}^{(k)})
      = \\ &=
      \rho(c_{n_k}^{(i)}, c_{n_i}^{(i)}) + \rho(d_i, d_k)
      < \\ &<
      \frac 1 i + \frac \varepsilon 2
      <
      \varepsilon.
    \end{align*}

    Hence
    \begin{align*}
      \rho(c^{(i)}, d)
      =
      \lim_{k \to \infty} \rho(c_k^{(i)}, d_k)
      =
      \lim_{k \to \infty} \rho(c_k^{(i)}, c_{n_k}^{(k)})
      <
      \varepsilon.
    \end{align*}

    Thus, given \( \varepsilon > 0 \), we found an index \( i_0 \) such that
    \begin{equation*}
      i \geq i_0 \implies \rho(c^{(i)}, d) < \varepsilon.
    \end{equation*}

    Thus \( d = \lim_{i \to \infty} c^{(i)} \) and \( (F, \rho) \) is a complete pseudometric space.

    \DItem{thm:metric_space_completion_existence/part_c} We construct an isometry of \( (X, \rho) \) into \( (F, \rho) \).

    Define the function
    \begin{align*}
      &\iota: X \to F \\
      &\iota(x) \coloneqq (x, x, x, \ldots),
    \end{align*}
    which sends each element of \( X \) into the corresponding constant sequence in \( F \).

    It is an isometry\Tinyref{def:isometry} since
    \begin{equation*}
      \rho(\iota(x),\iota(y)) = \lim_{i \to \infty} \rho(x, y) = \rho(x, y).
    \end{equation*}

    \DItem{thm:metric_space_completion_existence/part_d} We show that the image \( \iota(X) \) is dense in \( (F, \rho) \).

    Fix the fundamental sequence \( y \coloneqq \{ y_i \}_{i=1}^\infty \). Define the sequence \( x \) of sequences
    \begin{equation*}
      x^{(i)} \coloneqq \iota(y_i), i = 1, 2, \ldots.
    \end{equation*}

    It is fundamental in \( (F, \rho) \) since \( e \) is an isometry and since \( y \) is fundamental in \( (X, \rho) \).

    Fix \( \varepsilon > 0 \). Let \( i_0 \) be such that
    \begin{equation*}
      i, j \geq i_0 \implies \rho(y_i, y_j) < \varepsilon.
    \end{equation*}

    For \( i, k \geq i_0 \), we have
    \begin{align*}
      \rho(x_k^{(i)}, y_k)
      \leq
      \rho(x_k^{(i)}, y_i) + \rho(y_i, y_k)
      =
      0 + \rho(y_i, y_k)
      <
      \varepsilon,
    \end{align*}
    hence
    \begin{equation*}
      \rho(x^{(i)}, y) = \lim_{k \to \infty} \rho(x_k^{(i)}, y_k) < \varepsilon.
    \end{equation*}

    We conclude that \( x^{(i)} \xrightarrow[i \to \infty]{} y \) in \( (F, \rho) \), which implies that \( e(X) \) is dense in \( (F, \rho) \).

    \DItem{thm:metric_space_completion_existence/part_e} We build a complete metric space \( (C, \nu) \) from \( (F, \rho) \).

    We use \cref{thm:pseudometric_to_metric} to construct a complete metric space \( (C, \nu) \) from the complete pseudometric space \( (F, \rho) \).

    We adapt \( \iota \) to the equivalence classes on \( C \):
    \begin{align*}
      &\hat\iota: X \to C \\
      &\hat\iota(x) \coloneqq [\iota(x)].
    \end{align*}

    Thus \( \hat\iota \) embeds \( X \) into the complete metric space \( C \).
  \end{defenum}
\end{proof}

\begin{proposition}\label{thm:metric_space_completion_uniqueness}
  Let \( X \) be a metric space. If both \( f: X \to Y \) and \( g: X \to Z \) are completions\Tinyref{def:complete_metric_space} of \( X \), then \( Y \) and \( Z \) are isometric.
\end{proposition}
\begin{proof}
  Let \( y \in Y \) and let \( \{ x_i \}_{i \to \infty} \subseteq X \) be a sequence such that
  \begin{equation*}
    f(x_i) \xrightarrow[i \to \infty]{} y.
  \end{equation*}

  Such a sequence exists since \( f(X) \) is dense in \( Y \).

  Define \( z \coloneqq \lim_{i \to \infty} g(x_i) \). Since both \( f \) and \( g \) are isometries, \( z \) does not depend on the choice of sequence \( \{ x_i \}_{i \to \infty} \) such that \( f(x_i) \to y \). Furthermore, if \( z \in Z \) is given rather than \( y \in Y \), an analogous process allows us to determine \( y \) uniquely based on \( z \).

  Thus we have a bijective isometry between \( Y \) and \( Z \).
\end{proof}
