\subsection{Trigonometric functions}\label{subsec:trigonometric_functions}

\begin{Definition}\label{def:trigonometric_functions}
  We define the two basic \Def{trigonometric functions}. They are also called \Def{circular trigonometric functions} to distinguish them from the hyperbolic trigonometric functions defined and motivated in \fullref{def:hyperbolic_trigonometric_functions}.

  \begin{DefEnum}
    \ILabel{def:trigonometric_functions/sine} The \Def{sine} function, also called the \Def{sinus} function, is
    \begin{equation*}
      \sin(z)
      \coloneqq
      -i \sum_{m \text{ is odd}}^\infty \frac {i^m z^m} {m!}
      =
      -i \sum_{k=0}^\infty \frac {i^{2k+1} z^{2k+1}} {(2k + 1)!}
      =
      \sum_{k=0}^\infty \frac {i^{2k} z^{2k+1}} {(2k + 1)!}
    \end{equation*}

    By \fullref{thm:power_series_parity}, \( \sin(z) \) is an odd function.

    \ILabel{def:trigonometric_functions/cosine} The \Def{cosine} function, also called the \Def{cosinus} function, is
    \begin{equation*}
      \cos(z)
      \coloneqq
      \sum_{m \text{ is even}}^\infty \frac {i^m z^m} {m!}
      =
      \sum_{k=0}^\infty \frac {i^{2k} z^{2k}} {(2k)!}.
    \end{equation*}

    By \fullref{thm:power_series_parity}, \( \cos(z) \) is an even function.
  \end{DefEnum}

  \Fullref{def:geometric_trigonometric_functions} justifies the term \enquote{angle} for the parameter of the trigonometric functions.
\end{Definition}

\begin{Proposition}\label{thm:trigonometric_function_properties}
  \hyperref[def:trigonometric_functions]{Trigonometric functions} have the following basic properties:
  \begin{PropEnum}
    \ILabel{thm:trigonometric_function_properties/convergence} Both \( \sin(z) \) and \( \cos(z) \) converge in the entire complex plane.

    \ILabel{thm:trigonometric_function_properties/derivative} \( \sin'(z) = \cos(z) \) and \( \cos'(z) = -\sin(z) \) for all \( z \in \BC \).

    \ILabel{thm:trigonometric_function_properties/zeros} We have the following important roots of the trigonometric functions:
    \begin{align}
      \sin(0) = 0,   && \cos(0) = 1,    \label{thm:trigonometric_function_properties/zeros/zero} \\
      \sin(\pi) = 0, && \cos(\pi) = -1. \label{thm:trigonometric_function_properties/zeros/pi}
    \end{align}

    \ILabel{thm:trigonometric_function_properties/periodic} Both \( \sin \) and \( \cos \) are periodic with base period \( 2\pi \).

    \ILabel{thm:trigonometric_function_properties/bijective} For any integer \( k \), \( \sin \) is bijective from \( \left[(k - \tfrac 1 2) \pi, (k + \tfrac 1 2) \pi \right) \) to \( [0, 1] \) and \( \cos \) bijective from \( [k\pi, (k + 1)\pi) \) to \( [-1, 1] \).
  \end{PropEnum}
\end{Proposition}
\begin{RefListProof}
    \IRef{thm:trigonometric_function_properties/convergence} Note that the zero coefficients in the expansion of either \( \sin \) or \( \cos \) do not alter convergence. Therefore, by \fullref{thm:power_series_radius_of_convergence}, the radius of convergence is
    \begin{equation*}
      \limsup_{k \to \infty} \frac {\Abs{i^{k-1} k!}} {\Abs{i^k (k-1)!}}
      =
      \limsup_{k \to \infty} k
      =
      +\infty.
    \end{equation*}

    Hence the radius of convergence of both \( \sin(z) \) and \( \cos(z) \) is infinite.

    \IRef{thm:trigonometric_function_properties/derivative} This can be proved directly as in \fullref{thm:exponential_function_properties/derivative}.

    \IRef{thm:trigonometric_function_properties/zeros} \ref{thm:trigonometric_function_properties/zeros/zero} follows directly from \fullref{def:trigonometric_functions}.

    Now consider the \hyperref[def:function/extension]{restriction} of \( \cos \) to the real line. Since \( \cos(0) \neq 0 \) and \( \cos \) is continuously differentiable as a power series, in some neighborhood \( U \) of \( 0 \) we have \( 0 \not\in \cos(U) \). Therefore the inverse function theorem holds and there exists a neighborhood \( V \subseteq U \) of \( 1 \) such that the continuously differentiable function \( f: V \to \BR \) is the inverse of \( \cos \) in \( V \) (we have not yet defined \hyperref[def:inverse_trigonometric_functions/arccos]{\( \arccos \)}). If \( y = \cos(x) \), then
    \begin{equation*}
      Df(y)
      =
      \frac 1 {D\cos(x)}
      =
      \frac 1 {-\sin(x)}
      \overset {\ref{thm:trigonometric_identities/pythagorean}} =
      -\frac 1 {\sqrt{1 - y^2}},
      \quad y \in \cos(V).
    \end{equation*}

    The derivative is actually well-defined and continuous anywhere except for \( y \in \{ -1, 1 \} \). Therefore, for any \( \alpha \in (-1, 1) \),
    \begin{equation*}
      f(y) = f(\alpha) - \int_{\alpha}^y \frac 1 {\sqrt{1 - t^2}} dt, \quad y \in [\alpha, 1).
    \end{equation*}

    We already know that \( \cos(0) = 1 \), hence \( f(1) = 0 \) and, since \( f(y) \) is given by a convergent integral in \( [\alpha, 1) \), we can extend this interval to \( [\alpha, 1] \).

    By taking \( y = \alpha \), we obtain
    \begin{equation*}
      f(y) - f(-y) = -\int_{-y}^y \frac 1 {\sqrt{1 - t^2}} dt, \quad y \in [-1, 1].
    \end{equation*}

    Note that by \hyperref[def:pi]{our definition} of \( \pi \),
    \begin{equation*}
      \pi
      =
      \int_{-1}^1 \frac 1 {\sqrt{1 - t^2}} dt
      =
      -[\underbrace{f(1)}_{=0} - f(-1)]
      =
      f(-1).
    \end{equation*}

    Hence \( \cos(\pi) = -1 \). From \fullref{thm:trigonometric_identities/pythagorean},
    \begin{equation*}
      \Abs{\sin(\pi)} = \sqrt{1 - \cos(\pi)^2} = 0,
    \end{equation*}
    proving that \( \sin(\pi) = 0 \).

    This concludes the proof of \ref{thm:trigonometric_function_properties/zeros/pi}.

    \IRef{thm:trigonometric_function_properties/periodic} We will temporarily restrict ourselves to the real line. Since \( \cos(x) \) is continuous, \( \cos^{-1}(\{ 0 \}) \) is a closed set by \fullref{thm:weierstrass_extreme_value_theorem} there exists a minimum \( \gamma \) of \( [0, \pi] \cap \cos^{-1}(\{ 0 \}) \).

    Since, by \fullref{thm:trigonometric_function_properties/zeros}, \( \cos(0) = 1 \), it follows that \( \cos(x) > 0, x \in (-\gamma, \gamma) \). Therefore its primitive function \( \sin(x) \) increases on the same interval. It is also continuous, hence by \fullref{thm:trigonometric_identities/pythagorean}, \( \sin(\gamma) = 1 \).

    \( \sin \) is an odd function, therefore \( \sin(-\gamma) = \sin(\gamma) = -1 \).

    From \hyperref[def:pi]{our definition} of \( \pi \) it follows that
    \begin{equation*}
      \pi
      =
      \int_{-1}^1 \frac 1 {1 - t^2} dt
      =
      \int_{-\gamma}^\gamma \frac \cos(\varphi) {1 - \sin(\varphi)^2} d\varphi
      \overset {\ref{thm:trigonometric_identities/pythagorean}} =
      \int_{-\gamma}^\gamma \frac \cos(\varphi) {1 - \sin(\varphi)^2} d\varphi
      =
      \int_{-\gamma}^\gamma d\varphi
      =
      2\gamma.
    \end{equation*}

    In order for a number \( p \) to be a period of \( \sin \), we need to have \( \sin(p) = \sin(0) = 0 \). But we showed that \( \sin(x) \) is increasing from \( 0 \) to \( \tfrac \pi 2 \) and cannot possibly contain zeros in that interval. Hence \( p > \tfrac \pi 2 \).

    We also have \( \cos(\tfrac \pi 2) = 0 \). By \fullref{thm:trigonometric_identities/sums},
    \begin{equation*}
      \sin(\tfrac \pi 2 + x)
      =
      \sin(\tfrac \pi 2) \cos(x) + \cos(\tfrac \pi 2) \sin(x)
      =
      \cos(x).
    \end{equation*}

    Since \( \cos \) is positive on \( [0, \tfrac \pi 2) \), \( \sin \) is positive on \( [\tfrac \pi 2, \pi) \).

    We already showed in \fullref{thm:trigonometric_function_properties/zeros} that \( \sin(\pi) = 0 \).

    It follows that the minimal period of \( \sin \) is either \( \pi \) or a multiple of \( \pi \). It cannot be \( \pi \) since \( \cos(\pi) \neq \cos(0) \), therefore it must be \( 2\pi \).

    \IRef{thm:trigonometric_function_properties/bijective} % TODO
\end{RefListProof}

\begin{Proposition}\label{thm:trigonometric_identities}
  We have the following trigonometric identities:
  \begin{PropEnum}
    \ILabel{thm:trigonometric_identities/eulers_formula} (Euler's formula) For any \( z \in \BC \),
    \begin{equation}\label{thm:trigonometric_identities/eulers_formula/identity}
      e^{iz} = \cos(z) + i \sin(z).
    \end{equation}

    \ILabel{thm:trigonometric_identities/inverse_euler} (Inverse Euler's identities) For any \( z \in \BC \),
    \begin{align}
       \sin(z) &= \Real(e^z) = \frac {e^{iz} - e^{-iz}} {2i} \label{thm:trigonometric_identities/inverse_euler/sin} \\
       \cos(z) &= \Imag(e^z) = \frac {e^{iz} + e^{-iz}} 2 \label{thm:trigonometric_identities/inverse_euler/cos}
    \end{align}

    \ILabel{thm:trigonometric_identities/de_moivre} (De Moivre's formula) For any complex number \( z \) and any nonnegative integer \( n \),
    \begin{equation}\label{thm:trigonometric_identities/de_moivre/identity}
      (\cos(z) + i \sin(z))^n = \cos(nz) + i \sin(nz).
    \end{equation}

    \ILabel{thm:trigonometric_identities/pythagorean} (Pythagorean identity) For any \( z \in \BC \),
    \begin{equation}\label{thm:trigonometric_identities/pythagorean/identity}
      \sin(z)^2 + \cos(z)^2 = 1.
    \end{equation}

    \ILabel{thm:trigonometric_identities/products} (Products) For \( x, y \in \BC \),
    \begin{align}
      2 \sin(x) \sin(y) &= \cos(x - y) - \cos(x + y) \label{thm:trigonometric_identities/products/ss} \\
      2 \cos(x) \cos(y) &= \cos(x - y) + \cos(x + y) \label{thm:trigonometric_identities/products/cc} \\
      2 \sin(x) \cos(y) &= \sin(x - y) + \sin(x + y) \label{thm:trigonometric_identities/products/sc} \\
      2 \cos(x) \sin(y) &= -\sin(x - y) + \sin(x + y) \label{thm:trigonometric_identities/products/cs}
    \end{align}

    \ILabel{thm:trigonometric_identities/sums} (Sums) For \( x, y \in \BC \),
    \begin{align}
      \sin(x) + \sin(y) &= 2 \cos\left(\frac{x - y} 2 \right) \sin\left(\frac{x + y} 2 \right) \label{thm:trigonometric_identities/sums/sin_sum} \\
      \sin(x) - \sin(y) &= 2 \sin\left(\frac{x - y} 2 \right) \cos\left(\frac{x + y} 2 \right) \label{thm:trigonometric_identities/sums/sin_diff} \\
      \cos(x) + \cos(y) &= 2 \cos\left(\frac{x - y} 2 \right) \cos\left(\frac{x + y} 2 \right) \label{thm:trigonometric_identities/sums/cos_sum} \\
      \cos(x) - \cos(y) &= -2 \sin\left(\frac{x - y} 2 \right) \sin\left(\frac{x + y} 2 \right) \label{thm:trigonometric_identities/sums/cos_diff}
    \end{align}

    \ILabel{thm:trigonometric_identities/sum_of_angles} (Sum of angles) For \( x, y \in \BC \),
    \begin{align}
      \sin(x + y) &= \cos(x) \sin(y) + \cos(x) \sin(y) \label{thm:trigonometric_identities/products/sin} \\
      \cos(x + y) &= \cos(x) \cos(y) - \sin(x) \sin(y) \label{thm:trigonometric_identities/products/cos}
    \end{align}
  \end{PropEnum}
\end{Proposition}
\begin{proof}
  We need to give a direct proof because the most basic properties of \( \sin \) and \( \cos \) and even \( \exp \) depend this proposition.

  \begin{RefList}
    \IRef{thm:trigonometric_identities/eulers_formula} Simply note that \fullref{def:exponential_function} is a termwise sum of \fullref{def:trigonometric_functions/sine} and \fullref{def:trigonometric_functions/cosine}, therefore \fullref{thm:trigonometric_identities/eulers_formula/identity} holds.

    \IRef{thm:trigonometric_identities/inverse_euler} Follows from \fullref{thm:trigonometric_identities/eulers_formula}.

    \IRef{thm:trigonometric_identities/de_moivre} From \fullref{thm:trigonometric_identities/eulers_formula},
    \begin{equation*}
      (\cos(z) + i \sin(z))^n
      =
      {e^{iz}}^n
      \overset {\ref{thm:power_function_properties/composition}} {=}
      =
      e^{i(zn)}
      =
      \cos(nz) + i \sin(nz).
    \end{equation*}

    \IRef{thm:trigonometric_identities/pythagorean} We give a direct proof because \fullref{thm:trigonometric_identities/pythagorean/identity} is used in the proof of fundamental properties of \( \sin \), \( \cos \) and \( \exp \).

    We use Cauchy multiplication for
    \begin{align*}
      \sin(z)^2
      &=
      \sin(z) \cdot \sin(z)
      = \\ &=
      (-i \cdot -i) \left( \sum_{k=0}^\infty \frac {i^{2k+1} z^{2k+1}} {(2k+1)!} \right) \left( \sum_{k=0}^\infty \frac {i^{2k+1} z^{2k+1}} {(2k+1)!} \right)
      = \\ &=
      -\sum_{k=0}^\infty \sum_{m=0}^k \frac {i^{2m+1} z^{2m+1}} {(2m+1)!} \frac {i^{2(k-m)+1} z^{2(k-m)+1}} {(2(k-m)+1)!}
      = \\ &=
      -\sum_{k=0}^\infty \frac {i^{2k+2} z^{2k+2}} {(2k+2)!} \sum_{m=0}^k \binom {2k+2} {2m+1}
      = \\ &=
      -\sum_{k=1}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \sum_{m=0}^{k-1} \binom {2k} {2m+1}
    \end{align*}
    and for
    \begin{align*}
      \cos(z)^2
      &=
      \cos(z) \cdot \cos(z)
      = \\ &=
      \left( \sum_{k=0}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \right) \left( \sum_{k=0}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \right)
      = \\ &=
      \sum_{k=0}^\infty \sum_{m=0}^k \frac {i^{2m} z^{2m}} {(2m)!} \frac {i^{2(k-m)} z^{2(k-m)}} {(2(k-m))!}
      = \\ &=
      \sum_{k=0}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \sum_{m=0}^k \binom {2k} {2m}
    \end{align*}

    For the sum we obtain
    \begin{align*}
      \sin(z)^2 + \cos(z)^2
      &=
      1 + \sum_{k=1}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \left[ \sum_{m=0}^{k-1} \binom {2k} {2m+1} - \sum_{m=0}^k \binom {2k} {2m} \right]
      = \\ &=
      1 + \sum_{k=1}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \sum_{m=0}^k (-1)^m \binom {2k} m
      = \\ &=
      1 + \sum_{k=1}^\infty \frac {i^{2k} z^{2k}} {(2k)!} \underbrace{(1 - 1)^k}_0
      =
      1.
    \end{align*}

    \IRef{thm:trigonometric_identities/products} We will only prove \ref{thm:trigonometric_identities/products/ss} because the other identities are proved analogously. From \fullref{thm:trigonometric_identities/eulers_formula},
    \begin{align*}
      2 \sin(x) \sin(y)
      &=
      2 \frac 1 {4i^2} (e^{ix} - e^{-ix}) (e^{iy} - e^{-iy})
      = \\ &=
      - \frac 1 2 [\underbrace{e^{i(x+y)}} - e^{-i(x-y)} - e^{i(x-y)} + \underbrace{e^{-i(x+y)}}]
      = \\ &=
      - \left[\cos(x + y) - \cos(x - y)\right]
      = \\ &=
      \cos(x - y) - \cos(x + y).
    \end{align*}

    \IRef{thm:trigonometric_identities/sums} Fix some \( x, y \in \BC \) and define
    \begin{align*}
      t \coloneqq \frac {x + y} 2
      &&
      s \coloneqq \frac {x - y} 2
    \end{align*}
    so that \( x = t + s \) and \( y = t - s \).

    The identity \fullref{thm:trigonometric_identities/sums/sin_sum} the follows from \fullref{thm:trigonometric_identities/products/sc} applied to \( t \) and \( s \). The other identities are proved analogously.

    \IRef{thm:trigonometric_identities/sum_of_angles} We will only prove \fullref{thm:trigonometric_identities/products/sin} because \fullref{thm:trigonometric_identities/products/cos} is proved analogously. From \fullref{thm:trigonometric_identities/products/cs},
    \begin{align*}
      \sin(x + y)
      &=
      2 \cos(x) \sin(y) + \sin(x - y)
      \overset {\ref{thm:trigonometric_identities/products/sc}} = \\ &=
      2 \cos(x) \sin(y) + 2 \cos(x) \sin(y) - \sin(x + y).
    \end{align*}

    After dividing by \( 2 \), we obtain \fullref{thm:trigonometric_identities/products/sin}.
  \end{RefList}
\end{proof}

\begin{Definition}\label{def:hyperbolic_trigonometric_functions}
  In analogy with \fullref{thm:trigonometric_identities/inverse_euler}, we define \Def{hyperbolic trigonometric functions}.

  \begin{DefEnum}
    \ILabel{def:hyperbolic_trigonometric_functions/sine} The \Def{hyperbolic sine} function:
    \begin{equation*}
      \sinh(x) \coloneqq - \frac {e^x - e^{-x}} 2 \\
    \end{equation*}

    \ILabel{def:hyperbolic_trigonometric_functions/cosine} The \Def{hyperbolic cosine} function:
    \begin{equation*}
      \cosh(x) \coloneqq \frac {e^x + e^{-x}} 2
    \end{equation*}
  \end{DefEnum}

  Compare \fullref{def:quadratic_plane_curve/ellipse/parametric_equations} and \fullref{def:quadratic_plane_curve/hyperbola/parametric_equations} for a justification of the naming.
\end{Definition}

\begin{Definition}\label{def:derived_trigonometric_functions}
  In addition to \( \sin(z) \) and \( \cos(z) \), we define two additional functions, also called \enquote{trigonometric}.

  \begin{DefEnum}
    \ILabel{def:derived_trigonometric_functions/tan} The \hyperref[def:function/partial]{partial} \Def{tangent} function, also called \Def{tangens}, is
    \begin{equation*}
      \tan(z) \coloneqq \frac {\sin(z)} {\cos(z)}.
    \end{equation*}

    It is defined in \( \BC \setminus (\tfrac \pi 2 + \pi\BZ) \).

    \ILabel{def:derived_trigonometric_functions/cot} The \hyperref[def:function/partial]{partial} \Def{cotangent function}, also called \Def{cotangens}, is
    \begin{equation*}
      \cot(z) \coloneqq \frac {\cos(z)} {\sin(z)}.
    \end{equation*}

    It is defined in \( \BC \setminus \pi\BZ \).
  \end{DefEnum}
\end{Definition}

\begin{Definition}\label{def:inverse_trigonometric_functions}
  \Fullref{thm:trigonometric_function_properties/bijective} allows us to define \Def{inverse trigonometric functions}. We will thus restrict ourselves only to real numbers. Fix an integer \( k \). Unless noted otherwise, we assume \( k = 0 \).

  \begin{DefEnum}
    \ILabel{def:inverse_trigonometric_functions/arcsin} The \Def{arcus sinus} function \( \arcsin(x) \) is defined as the \hyperref[def:function/inverse]{inverse function} of \( \sin(x) \) (see \fullref{def:trigonometric_functions/sine}) from \( [-1, 1] \) to \( \left[(k - \tfrac 1 2) \pi, (k + \tfrac 1 2) \pi \right) \).

    \ILabel{def:inverse_trigonometric_functions/arccos} The \Def{arcus cosinus} function \( \arccos(x) \) is defined as the inverse of \( \cos(x) \) (see \fullref{def:trigonometric_functions/cosine}) from \( [-1, 1] \) to \( (k\pi, (k + 1)\pi) \).

    \ILabel{def:inverse_trigonometric_functions/arctan} The \Def{arcus tangens} function \( \arctan(x) \) is defined as the inverse of \( \tan(x) \) (see \fullref{def:derived_trigonometric_functions/tan}) from \( \BR \) to \( \left((k - \tfrac 1 2) \pi, (k + \tfrac 1 2) \pi \right) \).

    \ILabel{def:inverse_trigonometric_functions/arccot} The \Def{arcus cotangens} function \( \Op{arccot}(x) \) is defined as the inverse of \( \cot(x) \) (see \fullref{def:derived_trigonometric_functions/cot}) from \( \BR \) to \( (k\pi, (k + 1)\pi) \).

    \ILabel{def:inverse_trigonometric_functions/arctantwo} The \Def{two-argument arcus tangens} function \( \ATanTwo(y, x) \) is a bit special, however it is very useful in practice - see \fullref{thm:arctantwo}. It is defined as
    \begin{align*}
      &\ATanTwo: \BR^2 \setminus \{ 0 \} \to [2k\pi, 2k\pi + 2) \\
      &\ATanTwo(y, x) \coloneqq \begin{cases}
        \arctan(\tfrac y x),       &x > 0 \\
        \arctan(\tfrac y x) + \pi, &x < 0 \Tand y \geq 0 \\
        \arctan(\tfrac y x) - \pi, &x < 0 \Tand y < 0 \\
        \pi,                       &x = 0 \Tand y \geq 0 \\
        -\pi,                      &x = 0 \Tand y < 0.
      \end{cases}
    \end{align*}
  \end{DefEnum}
\end{Definition}

\begin{Proposition}\label{thm:arctantwo}
  Fix an integer \( k \). Given \( (x_0, y_0) \in S_{\BR^2} \), \( t_0 \coloneqq \ATanTwo(y_0, x_0) \) is the unique solution to the equation
  \begin{equation}\label{thm:arctantwo/equation}
    \begin{cases}
      x_0 = \cos(t) \\
      y_0 = \sin(t)
    \end{cases}
  \end{equation}
  in \( t \in [2k\pi, 2k\pi + 2) \).
\end{Proposition}
